(function(){var e,t,n;n=Em.set,t=Em.get,e=Em.EnumerableUtils.forEach,Ember.ArrayPipelineMixin=Ember.Mixin.create({results:Ember.computed(function(t,n){var r;return arguments.length===1?(r=this.get("_processors"),e(r,function(e){return e._recalculate()}),r.length?this.get("_processors.lastObject._prevResults"):this.get("content")):n}),plugins:null,_processors:null,_observerMap:null,previousResults:function(e){var t;return t=this.get("_processors").indexOf(e),t===-1?[]:t===0?this.get("content"):this.get("_processors").objectAt(t-1).get("_prevResults")},init:function(){return this._super(),this.get("content")==null&&this.set("content",[]),this._configurePlugins(),this._configureObserverMap(),this._registerObservers()},_initPlugin:function(e){return typeof e=="string"&&(e=t(e)),this.get("_processors").pushObject(e.create({controller:this}))},_configurePlugins:function(){var e=this;return this.get("plugins")==null&&this.set("plugins",[]),this.set("_processors",[]),this.get("plugins").forEach(function(t){return e._initPlugin(t)})},_configureObserverMap:function(){var t;return t=Em.Map.create(),e(this.get("_processors"),function(n){return e(n.get("observes"),function(e){if(!t.get(e))return t.set(e,n)})}),this.set("_observerMap",t)},_observerKeysForController:function(){var e,t;return t=new RegExp("^controller.(.+)$"),e=[],this.get("_observerMap")!=null&&this.get("_observerMap").keys.toArray().forEach(function(n){var r;r=n.match(t);if(r!=null)return e.pushObject(r[1])}),e}.property("_observerMap.@each"),_observerKeysForObjects:function(){var e;return e=new RegExp("^controller.(.+)$"),this.get("_observerMap")!=null?this.get("_observerMap").keys.toArray().filter(function(t){return!t.match(e)}):[]}.property("_observerMap.@each"),_registerObservers:function(){var t,n,r,i,s;return s=this,t=this.get("content")||[],n=this.get("controller"),i=this.get("_observerKeysForObjects"),r=this.get("_observerKeysForController"),e(t,function(t){return e(i,function(e){return t.addObserver(e,s,s._processChanges)})}),e(r,function(e){return s.addObserver(e,s,s._processChanges)})},_unregisterObservers:function(){var t,n,r,i;return i=this,t=this.get("content")||[],r=this.get("_observerKeysForObjects"),n=this.get("_observerKeysForController"),e(t,function(t){return e(r,function(e){return t.removeObserver(e,i,i._processChanges)})}),e(n,function(e){return i.removeObserver(e,i,i._processChanges)})},_processChanges:function(e,t){var n,r,i,s,o,u,a;e===this&&(t="controller."+t),r=this.get("_observerMap").get(t),n=this.get("_processors").indexOf(r),a=this.get("_processors").slice(n);for(o=0,u=a.length;o<u;o++)i=a[o],i._recalculate();return s=this.get("_processors.lastObject._prevResults"),this.set("results",s)},pipelineContentWillChange:function(){return this._unregisterObservers()}.observesBefore("content"),pipelineContentDidChange:function(){return this._registerObservers()}.observes("content")}),Em.PipePlugin=Em.Object.extend({controller:null,observes:null,_prevResults:null,process:function(e){return e},init:function(){this._super();if(this.get("observes")==null)return this.set("observes",[])},_recalculate:function(){var e,t;return e=this._lastResult()||[],t=this.process(e),this.set("_prevResults",t)},_lastResult:function(){return this.get("controller").previousResults(this)}})}).call(this);